<div class="top-bar app-header" *ngIf="user">
  <div class="d-flex align-items-center justify-content-between gap-4">
    <div class="left-section d-flex align-items-center gap-3">
      <div class="menu" (click)="toggleMenu.emit()">
        <i class="bi bi-list"></i>
      </div>

      <!-- Module Selector -->
      <div class="module-selector-wrapper">
        <app-module-selector></app-module-selector>
      </div>
    </div>

    <div class="d-flex align-items-center gap-2 position-relative">
      <input
        class="form-control m-0"
        placeholder="Search assets..."
        (input)="search()"
        type="search"
        [(ngModel)]="query"
      />

      <div class="search-results position-absolute w-fit p-2" *ngIf="query">
        <div *ngIf="searchResults.length > 0 && !loading">
          <a
            (click)="query = ''; searchResults = []"
            [routerLink]="['/asset', asset.id]"
            *ngFor="let asset of searchResults"
          >
            {{ asset.name }}
          </a>
        </div>

        <!-- Empty state -->
        <div *ngIf="searchResults.length === 0 && !loading">
          <p>No results found</p>
        </div>

        <!-- Loading state -->
        <div *ngIf="loading">
          <p>Loading...</p>
        </div>
      </div>
      <!-- <p>
        <i class="bi bi-bell"></i>
      </p> -->
      <p class="pointer">
        <i class="bi bi-person"></i>
        Hi {{ user.Name }}
        <i class="bi bi-chevron-down"></i>
        <span class="user-options">
          <a routerLink="/profile"> <i class="bi bi-person"></i> Profile </a>
          <a (click)="logout()">
            <i class="bi bi-box-arrow-right"></i> Logout
          </a>
        </span>
      </p>
    </div>
  </div>
</div>
