<div class="module-selector" (clickOutside)="closeDropdown()">
  <div class="current-module" (click)="toggleDropdown()">
    <div class="module-info" *ngIf="currentModule$ | async as currentModule">
      <i [class]="currentModule.icon" class="module-icon"></i>
      <div class="module-details">
        <span class="module-name">{{ currentModule.name }}</span>
        <small class="module-description">{{ currentModule.description }}</small>
      </div>
    </div>
    <i class="bi bi-chevron-down dropdown-arrow" 
       [class.rotated]="isDropdownOpen"></i>
  </div>

  <div class="module-dropdown" *ngIf="isDropdownOpen" [@slideDown]>
    <div class="dropdown-header">
      <h6>Switch Module</h6>
      <p class="text-muted">Select a module to work with</p>
    </div>
    
    <div class="module-list">
      <div class="module-option" 
           *ngFor="let module of availableModules$ | async"
           [class.active]="(currentModule$ | async)?.id === module.id"
           (click)="switchModule(module.id)">
        <div class="module-option-content">
          <i [class]="module.icon" class="module-option-icon"></i>
          <div class="module-option-details">
            <span class="module-option-name">{{ module.name }}</span>
            <small class="module-option-description">{{ module.description }}</small>
          </div>
        </div>
        <i class="bi bi-check-circle-fill active-indicator" 
           *ngIf="(currentModule$ | async)?.id === module.id"></i>
      </div>
    </div>

    <div class="dropdown-footer">
      <small class="text-muted">
        <i class="bi bi-info-circle"></i>
        Module access is controlled by your user permissions
      </small>
    </div>
  </div>
</div>
